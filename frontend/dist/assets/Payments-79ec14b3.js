import{_ as b,r as d,l as h,m as M,o as r,c as l,b as e,j as w,e as c,k as v,F as f,n as _,v as k,t as s,g as D,h as y,s as L}from"./index-7cd8eeb4.js";const S={name:"Payments",setup(){const i=d(!1),t=d([]),m=d([]),n=d({loanId:"",amount:"",paymentMethod:""}),p=h(()=>t.value.filter(o=>(o.status==="active"||o.status==="approved")&&o.balance>0)),u=async()=>{try{const o=await y.get("/api/loans");t.value=o.data}catch(o){console.error("Error fetching loans:",o)}},a=async()=>{try{const o=await y.get("/api/payments");m.value=o.data}catch(o){console.error("Error fetching payments:",o)}},g=async()=>{i.value=!0;try{await y.post("/api/payments",n.value),alert("Payment processed successfully!"),n.value={loanId:"",amount:"",paymentMethod:""},await u(),await a()}catch{alert("Payment failed. Please try again.")}finally{i.value=!1}},P=o=>new Date(o).toLocaleDateString();return M(async()=>{await u(),await a()}),{form:n,loading:i,activeLoans:p,payments:m,handlePayment:g,formatDate:P}}},x={class:"container",style:{"margin-top":"30px"}},C={class:"card"},I={class:"form-group"},B=["value"],U={class:"form-group"},V={class:"form-group"},q=["disabled"],A={key:0,class:"card"},E={class:"payment-history"},T={class:"payment-info"};function F(i,t,m,n,p,u){return r(),l("div",x,[e("div",C,[t[9]||(t[9]=e("h2",null,"Make a Payment",-1)),e("form",{onSubmit:t[3]||(t[3]=w((...a)=>n.handlePayment&&n.handlePayment(...a),["prevent"]))},[e("div",I,[t[5]||(t[5]=e("label",null,"Select Loan",-1)),c(e("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>n.form.loanId=a),required:""},[t[4]||(t[4]=e("option",{value:""},"Select a loan",-1)),(r(!0),l(f,null,_(n.activeLoans,a=>(r(),l("option",{key:a._id,value:a._id},s(a.loanType)+" - Balance: $"+s(a.balance),9,B))),128))],512),[[v,n.form.loanId]])]),e("div",U,[t[6]||(t[6]=e("label",null,"Payment Amount ($)",-1)),c(e("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>n.form.amount=a),type:"number",min:"1",step:"0.01",required:""},null,512),[[k,n.form.amount]])]),e("div",V,[t[8]||(t[8]=e("label",null,"Payment Method",-1)),c(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>n.form.paymentMethod=a),required:""},t[7]||(t[7]=[e("option",{value:""},"Select Payment Method",-1),e("option",{value:"bank_account"},"Bank Account",-1),e("option",{value:"credit_card"},"Credit Card",-1),e("option",{value:"debit_card"},"Debit Card",-1)]),512),[[v,n.form.paymentMethod]])]),e("button",{type:"submit",class:"btn btn-primary",disabled:n.loading},s(n.loading?"Processing...":"Make Payment"),9,q)],32)]),n.payments.length>0?(r(),l("div",A,[t[10]||(t[10]=e("h2",null,"Payment History",-1)),e("div",E,[(r(!0),l(f,null,_(n.payments,a=>(r(),l("div",{key:a._id,class:"payment-item"},[e("div",T,[e("h4",null,"$"+s(a.amount),1),e("p",null,s(a.loanId.loanType)+" Loan",1),e("p",null,s(n.formatDate(a.paymentDate)),1),e("span",{class:L(["payment-status",a.status])},s(a.status),3)])]))),128))])])):D("",!0)])}const j=b(S,[["render",F],["__scopeId","data-v-75f22e4d"],["__file","C:/Users/User/RestoreLoans-Application/frontend/src/views/Payments.vue"]]);export{j as default};
